# Batch contexts

This page describes contexts the [Batch workflow](batch-workflow-syntax.md) can use expressions for calculating YAML attribute values.

## Batch Contexts

| Context name | Description |
| :--- | :--- |
| `flow` | Information about the main workflow settings, defaults, etc. See [`flow` context](batch-contexts.md#flow-context) for details. |
| `params` | A mapping of workflow-global parameters. For more information, see [`params` context.](batch-contexts.md#params-context) |
| `env` | Contains environment variables set in a workflow defaults. For more information, see [`env` context](batch-contexts.md#env-context) . |
| `tags` | A set of job tags set in a workflow defaults. See [`tags` context](batch-contexts.md#tags-context) for details. |
| `volumes` | Contains a mapping of volume definitions. For more information, see [`volumes` context](batch-contexts.md#volumes-context). |
| `images` | Contains a mapping of docker images from [workflow config](batch-workflow-syntax.md#images). See [`images` context](batch-contexts.md#images-context) for details. |
| `strategy` | Contains information about some strategies from [flow defaults](batch-workflow-syntax.md#defaults). See [`strategy` context](batch-contexts.md#strategy-context) for details. |
| `matrix` | Contains combination data generated by the [`tasks.strategy.matrix`](batch-workflow-syntax.md#tasks-strategy-matrix). See [`matrix` context](batch-contexts.md#matrix-context) for details.  |
| `needs` | Contains outputs generated by tasks from [`tasks.needs`](batch-workflow-syntax.md#tasks-needs). See [`needs` context](batch-contexts.md#needs-context) for details. |

### `flow` context

The `flow`context contains information about the workflow: it's id, title, etc.

| Property name | Type | Description |
| :--- | :--- | :--- |
| `flow.flow_id` | `str` | The workflow id. It is auto-calculated from the workflow's YAML filename with a dropped suffix. You can override the property by setting [`flow.id`](batch-workflow-syntax.md#id)attribute. |
| `flow.project_id` | `str` | The project id. See also [the project configuration](project-configuration-syntax.md#id). |
| `flow.workspace` | `LocalPath` | A path to the workspace \(the root folder of the project\). |
| `flow.title` | `str` | The workflow title. Set [`flow.title`](batch-workflow-syntax.md#title) attribute to override auto-calculated value. |

### `params` context

Parameter described in [`params` attribute](batch-workflow-syntax.md#params) .

| Property name | Type | Description |
| :--- | :--- | :--- |
| `params.<param-name>` | `str` | The value of a specific parameter. |

### `env` context

The `env` context contains environment variables that have been set in the [workflow defaults](batch-workflow-syntax.md#defaults-env). For more information about setting environment variables in your workflow, see "[Batch workflow syntax](batch-workflow-syntax.md#batch-workflow)."

The `env` context syntax allows you to use the value of an environment variable in your workflow file. If you want to use the value of an environment variable inside a job, use the operating system's normal method for reading environment variables.

| Property name | Type | Description |
| :--- | :--- | :--- |
| `env.<env-name>` | `str` | The value of a specific environment variable. |

### `tags` context

A set of job tags.

Tags available in this context are combined from system tags \(`project:<project-id>`, `flow:<flow-id>`, `task:<task-id>`\) and flow default tags \(see [`defaults.tags` attribute](live-workflow-syntax.md#defaults-tags)\).

| Property name | Type | Description |
| :--- | :--- | :--- |
| `tags` | `set[str]` | This context changes for each job. You can access this context from any job. |

### `volumes` context

Contains information about volumes defined in [`volumes` section ](batch-workflow-syntax.md#volumes)of _batch_ workflow.

<table>
  <thead>
    <tr>
      <th style="text-align:left">Property name</th>
      <th style="text-align:left">Type</th>
      <th style="text-align:left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.id</code>
      </td>
      <td style="text-align:left"><code>str</code>
      </td>
      <td style="text-align:left">The volume definition identifier. For more information, see <a href="batch-workflow-syntax.md#volumes-less-than-volume-id-greater-than"><code>volumes.&lt;volume-id&gt;</code> section</a>.</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.remote</code>
      </td>
      <td style="text-align:left"><code>URL</code>
      </td>
      <td style="text-align:left">Remote volume URI, e.g. <code>storage:path/to</code>.
        <br />For more information, see <a href="batch-workflow-syntax.md#volumes-less-than-volume-id-greater-than-remote"><code>volumes.&lt;volume-id&gt;.remote</code> attribute</a>.</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.mount</code>
      </td>
      <td style="text-align:left"><code>RemotePath</code>
      </td>
      <td style="text-align:left">
        <p>The path inside a job where the volume should be mounted in.</p>
        <p>For more information, see <a href="batch-workflow-syntax.md#volumes-less-than-volume-id-greater-than-mount"><code>volumes.&lt;volume-id&gt;.mount</code> attribute</a>.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.read_only</code>
      </td>
      <td style="text-align:left"><code>bool</code>
      </td>
      <td style="text-align:left">
        <p><code>True</code> if the volume is mounted in read-only mode, <code>False</code> otherwise.</p>
        <p>For more information, see <a href="batch-workflow-syntax.md#volumes-less-than-volume-id-greater-than-read_only"><code>volumes.&lt;volume-id&gt;.read_only</code> attribute</a>.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.local</code>
      </td>
      <td style="text-align:left"> <code>None</code>
      </td>
      <td style="text-align:left">In <em>batch</em> workflows, this property is always <code>None</code>.</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.full_local_path</code>
      </td>
      <td style="text-align:left"><code>LocalPath</code> or <code>None</code>
      </td>
      <td style="text-align:left">Full version of <code>local</code> property.</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.ref</code>
      </td>
      <td style="text-align:left"><code>str</code>
      </td>
      <td style="text-align:left">
        <p>A volume reference that can be used as a <a href="batch-workflow-syntax.md#task-volumes"><code>task.volumes</code> item</a>.
          The calculated value looks like <code>storage:path/to:/mnt/path:rw</code>.</p>
        <p>The value is assembled from <code>remote</code>, <code>mount</code>, and <code>read_only</code> properties.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.ref_ro</code>
      </td>
      <td style="text-align:left"><code>str</code>
      </td>
      <td style="text-align:left">Like <code>ref</code> but <em>read-only</em> mode is enforced.</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>volumes.&lt;volume-id&gt;.ref_rw</code>
      </td>
      <td style="text-align:left"><code>str</code>
      </td>
      <td style="text-align:left">Like <code>ref</code> but <em>read-write</em> mode is enforced.</td>
    </tr>
  </tbody>
</table>

### `images` context

Contains information about images defined in [`images` section](batch-workflow-syntax.md#images) of _batch_ workflow.

| Property name | Type | Description |
| :--- | :--- | :--- |
| `images.<image-id>.id` | `str` | The image definition identifier. For more information, see [`images.<image-id>`](batch-workflow-syntax.md#images-less-than-image-id-greater-than) section. |
| `images.<image-id>.ref` | `str` | The image reference. For more information, see [`images.<image-id>.ref`](batch-workflow-syntax.md#images-less-than-image-id-greater-than-ref) attribute. |
| `images.<image-id>.context` | `None` | In _batch_ workflows, this property is always `None`. |
| `images.<image-id>.full_context_path` | `None` | In _batch_ workflows, this property is always `None`. |
| `images.<image-id>.dockerfile` | `None` | In _batch_ workflows, this property is always `None`. |
| `images.<image-id>.full_dockerfile_path` | `None` | In _batch_ workflows, this property is always `None`. |
| `images.<image-id>.build_args` | `list[str]` | In _batch_ workflows, this property is always `[]`\(empty list\). |
| `images.<image-id>.env` | `dict[str, str]` | In _batch_ workflows, this property is always `{}`\(empty dict\). |
| `images.<image-id>.volumes` | `list[str]` | In _batch_ workflows, this property is always `[]`\(empty list\). |

### `strategy` context

Contains information about some strategies of execution set in the [flow defaults](batch-workflow-syntax.md#defaults). 

| Property name | Type | Description |
| :--- | :--- | :--- |
| `strategy.fail_fast` | `bool` | Task failure processing strategy. For more information, see [`defaults.fail_fast`](batch-workflow-syntax.md#defaults-fail_fast) attribute. |
| `strategy.max_parallel` | `int` | The maximum number of tasks can execute at the same time.For more information, see [`defaults.max_parallel`](batch-workflow-syntax.md#defaults-max_parallel) attribute. |

### `matrix` context

Contains parameters from a combination generated by the [`tasks.strategy.matrix`](batch-workflow-syntax.md#tasks-strategy-matrix) attribute.

| Property name | Type | Description |
| :--- | :--- | :--- |
| `matrix.<param-name>` | `bool` or `int` or `float` or `str` or `None`  | The matrix parameter value for the current combination. |

### `needs` context

Contains outputs generated by tasks that were specified in the [`tasks.needs`](batch-workflow-syntax.md#tasks-needs) attribute.

| Property name | Type | Description |
| :--- | :--- | :--- |
| `needs.<task-id>.result` | `str` | State of the completed task `<task-id>`. Can be one of: `"succedded"`, `"failed"`, `"cancelled"`, `"skipped"`. |
| `needs.<task-id>.outputs.<output-name>` | `str` | The value  of output `<output-name>` produced by task `<task-id>.`  |

